{% extends 'site.html' %}
{% block title %}Race Listing{% endblock %}
{% block content %}
<h1>Race Listing</h1>
<div id="ajax">
<h2>Leader Board</h2>
<ul>
	<li>
		<div class="result_col" style="width: 80%;"><strong>Crew</strong></div>
		<div class="result_col" style="width: 20%;"><strong>Time</strong></div>
		<div style="clear: both;"></div>
	</li>
  {% for result in leaders %}
    <li>
      <div class="result_col" style="width: 80%;">{{ result.lastName }}, {{ result.firstName }}</div> 
	<div class="result_col" style="width: 20%;">{{ result.finalTime }}</div> 
	<div style="clear: both;"></div>
    </li>
  {% endfor %}
</ul>
<h2>Races</h2>
<ul>
	 {% for race in object_list %}
	<li>
		{% if race.hasResults %}<a href="{% url results.views.show_results key=race.key %}">{% endif %}
		{{ race.description }}
		{% if race.hasResults %}</a>{% endif %}
	</li>
	{% endfor %}
</ul>
</div>
<script>
function refreshresults() {
	var oXMLHttpRequest = new XMLHttpRequest();
	oXMLHttpRequest.open("GET", "/ajax", true); 
	oXMLHttpRequest.onreadystatechange = function() { 
		if (this.readyState == XMLHttpRequest.DONE) { 
			var el = document.getElementById('ajax');
			el.innerHTML = this.responseText;
		} 
	} 
	oXMLHttpRequest.send(null);
	t=setTimeout("refreshresults()", 10000);
}
refreshresults();
</script>
{% endblock %}